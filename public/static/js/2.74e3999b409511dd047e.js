webpackJsonp([2],{495:function(e,t,a){a(631);var r=a(181)(a(552),a(675),"data-v-38c4608c",null);e.exports=r.exports},509:function(e,t,a){e.exports={default:a(512),__esModule:!0}},510:function(e,t){t.f={}.propertyIsEnumerable},511:function(e,t){t.f=Object.getOwnPropertySymbols},512:function(e,t,a){a(514),e.exports=a(47).Object.assign},513:function(e,t,a){"use strict";var r=a(184),o=a(511),i=a(510),n=a(185),d=a(186),l=Object.assign;e.exports=!l||a(124)(function(){var e={},t={},a=Symbol(),r="abcdefghijklmnopqrst";return e[a]=7,r.split("").forEach(function(e){t[e]=e}),7!=l({},e)[a]||Object.keys(l({},t)).join("")!=r})?function(e,t){for(var a=n(e),l=arguments.length,s=1,c=o.f,u=i.f;l>s;)for(var g,f=d(arguments[s++]),m=c?r(f).concat(c(f)):r(f),p=m.length,h=0;p>h;)u.call(f,g=m[h++])&&(a[g]=f[g]);return a}:l},514:function(e,t,a){var r=a(79);r(r.S+r.F,"Object",{assign:a(513)})},515:function(e,t,a){"use strict";t.__esModule=!0;var r=a(509),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=o.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}},536:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(568);t.default={name:"tree-grid",props:{treeStructure:{type:Boolean,default:function(){return!1}},columns:{type:Array,default:function(){return[]}},dataSource:{type:Array,default:function(){return[]}},requestUrl:{type:String,default:function(){return""}},treeType:{type:String,default:function(){return"normal"}},defaultExpandAll:{type:Boolean,default:function(){return!0}}},data:function(){return{rowData:"",tableHeight:""}},created:function(){var e=this;this.tableHeight=document.documentElement.clientHeight-133,window.onresize=function(){e.tableHeight=document.documentElement.clientHeight-133}},computed:{data:function(){var e=this;if(e.treeStructure){return r.a.MSDataTransfer.treeToArray(e.dataSource,null,null,e.defaultExpandAll)}return e.dataSource}},methods:{showTr:function(e,t){var a=!e._parent||e._parent._expanded&&e._parent._show;return e._show=a,a?"":"display:none;"},toggle:function(e){var t=this,a=t.data[e];a._expanded=!a._expanded},spaceIconShow:function(e){return!(!this.treeStructure||0!==e)},toggleIconShow:function(e,t){return!!(this.treeStructure&&0===e&&t.children&&t.children.length>0)},select:function(e){this.rowData=e,this.$emit("transRow",this.rowData)}}}},552:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(515),o=a.n(r),i=a(566),n=(a.n(i),a(183)),d=a(182);t.default={name:"hello",data:function(){return{buttonData:[],tableData:"",rowData:"",addBranchList:[],orgData:"",columns:[{text:"机构名称",dataIndex:"orgName",width:200},{text:"机构号",dataIndex:"orgId",width:120},{text:"机构描述",dataIndex:"remark",width:240},{text:"机构状态",dataIndex:"status",width:120},{text:"创建时间",dataIndex:"formtTime",width:180}],dataSource:[],addVisiable:!1,addLoading:!1,addForm:{addorgName:"",addorgParentId:"",addorgContact:"",addorgTel:"",addorgAddress:"",addremark:""},editVisiable:!1,editLoading:!1,editForm:{editorgName:"",editorgParentId:"",editorgContact:"",editorgTel:"",editorgAddress:"",editremark:""},rules:{addorgName:[{required:!0,trigger:"blur",message:"请输入机构名称"},{max:64,message:"输入字符长度不超过64个",trigger:"blur"},{validator:function(e,t,a){0==/^\S*$/.test(t)?a(new Error("不能包含空格")):a()},trigger:"blur"}],addorgParentId:[{type:"number",required:!0,trigger:"change",message:"请输选择上级机构"}],addorgContact:[{required:!0,trigger:"blur",message:"请输入机构联系人"},{max:64,message:"输入字符长度不超过64个",trigger:"blur"},{validator:function(e,t,a){0==/^\S*$/.test(t)?a(new Error("不能包含空格")):a()},trigger:"blur"}],addorgTel:[{required:!0,trigger:"blur",message:"请输入机构联系电话"},{max:11,message:"输入字符长度不超过11个",trigger:"blur"},{validator:function(e,t,a){0==/^\S*$/.test(t)?a(new Error("不能包含空格")):a()},trigger:"blur"}],addorgAddress:[{max:256,message:"输入字符长度不超过256个",trigger:"blur"},{validator:function(e,t,a){0==/^\S*$/.test(t)?a(new Error("不能包含空格")):a()},trigger:"blur"}],addremark:[{max:256,message:"输入字符长度不超过256个",trigger:"blur"}],editorgName:[{required:!0,trigger:"blur",message:"请输入机构名称"},{max:64,message:"输入字符长度不超过64个",trigger:"blur"},{validator:function(e,t,a){0==/^\S*$/.test(t)?a(new Error("不能包含空格")):a()},trigger:"blur"}],editorgParentId:[{type:"number",required:!0,trigger:"change",message:"请输选择上级机构"}],editorgContact:[{required:!0,trigger:"blur",message:"请输入机构联系人"},{max:64,message:"输入字符长度不超过64个",trigger:"blur"},{validator:function(e,t,a){0==/^\S*$/.test(t)?a(new Error("不能包含空格")):a()},trigger:"blur"}],editorgTel:[{required:!0,trigger:"blur",message:"请输入机构联系电话"},{max:11,message:"输入字符长度不超过11个",trigger:"blur"},{validator:function(e,t,a){0==/^\S*$/.test(t)?a(new Error("不能包含空格")):a()},trigger:"blur"}],editorgAddress:[{max:256,message:"输入字符长度不超过256个",trigger:"blur"},{validator:function(e,t,a){0==/^\S*$/.test(t)?a(new Error("不能包含空格")):a()},trigger:"blur"}],editremark:[{max:256,message:"输入字符长度不超过256个",trigger:"blur"}]},roleVisible:!1,appLoading:!1,role:"",roleList:[]}},mounted:function(){this.reloadBranchList();var e="";if(window.localStorage){e=window.localStorage.getItem("popedoms")}else e=localStorage.getItem("popedoms");if(this.buttonData=[],e)for(var t=JSON.parse(e),a=t.length,r=0;r<a;r++)2==t[r].popedomButton&&this.buttonData.push(t[r]);this.reload()},computed:o()({},a.i(n.b)(["popedomList"])),methods:o()({},a.i(n.c)(["getPopedom"]),{reloadBranchList:function(){var e=this;a.i(d.a)(this,{},"/aas/admin/organ/findAllOpened.do",function(t){t.data&&(e.addBranchList=t.data)})},reload:function(){var e=this;a.i(d.a)(this,{},"/aas/admin/organ/findAllByOrgId.do",function(t){t.data&&(e.dataSource=[],e.orgData=t.data,e.tableData=t.data[0],e.changeDataFn(e.tableData,e.orgData),e.dataSource.push(e.tableData))})},transRow:function(e){this.rowData=e},buttonClick:function(e){var t=this;switch(e){case"openAddDialog()":t.openAddDialog();break;case"openEditDialog()":t.openEditDialog();break;case"openDeleteDialog()":t.openDeleteDialog();break;case"openCloseDialog()":t.openCloseDialog();break;case"openOpenDialog()":t.openOpenDialog();break;case"openAppConfigDialog()":t.openAppConfigDialog()}},openAddDialog:function(){if(this.isSelect()){if("1"===this.rowData.orgStatus)return void this.$notify.warning({title:"消息",message:"停用状态下无法添加机构"});if("2"===this.rowData.orgStatus)return void this.$notify.warning({title:"消息",message:"注销状态下无法添加机构"});this.$refs.addForm&&this.$refs.addForm.resetFields(),this.addLoading=!1,this.addVisiable=!0,this.addForm.addorgParentId=this.rowData.orgId}},checkOrgName:function(){var e=this;this.$refs.addForm.validate(function(t){t&&(e.addLoading=!0,a.i(d.b)(e,{orgName:e.addForm.addorgName},"/aas/admin/organ/checkOrgName.do",function(t){t.data.type?e.addOrg():(e.addLoading=!1,e.$message({message:"机构名已存在，请重新输入",type:"warning"}),e.$refs.addInput.$el.firstElementChild.select())},!0))})},addOrg:function(){var e=this;this.$refs.addForm.validate(function(t){if(!t)return!1;e.addLoading=!0;var r={};for(var o in e.addForm)r[o.substring(3)]=e.addForm[o];a.i(d.b)(e,r,"/aas/admin/organ/insertOrg.do",function(t){t.data&&t.data.type&&(e.addVisiable=!1,e.$message({message:"添加成功",type:"success"}),e.reload(),e.reloadBranchList()),e.addLoading=!1})})},openEditDialog:function(){if(this.isSelect()){if("1"===this.rowData.orgStatus)return void this.$notify.warning({title:"消息",message:"停用状态下无法更新机构"});if("2"===this.rowData.orgStatus)return void this.$notify.warning({title:"消息",message:"注销状态下无法更新机构"});for(var e in this.editForm)this.editForm[e]=this.rowData[e.substring(4)];this.editLoading=!1,this.editVisiable=!0}},editOrg:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return!1;e.editLoading=!0;var r={orgId:e.rowData.orgId,orgName:e.editForm.editorgName,orgParentId:e.editForm.editorgParentId,orgContact:e.editForm.editorgContact,orgTel:e.editForm.editorgTel,orgAddress:e.editForm.editorgAddress,remark:e.editForm.editremark};a.i(d.b)(e,r,"/aas/admin/organ/updateOrg.do",function(t){t.data&&t.data.type&&(e.editVisiable=!1,e.$message({message:"修改成功",type:"success"}),e.reload(),e.reloadBranchList()),e.editLoading=!1})})},openDeleteDialog:function(){this.isSelect()&&this.confirm("确定注销此机构？","/aas/admin/organ/deleteOrg.do","注销成功")},openCloseDialog:function(){this.isSelect()&&this.confirm("确定停用此机构？","/aas/admin/organ/closeOrg.do","停用成功")},openOpenDialog:function(){this.isSelect()&&this.confirm("确定启用此机构？","/aas/admin/organ/openOrg.do","启用成功")},openAppConfigDialog:function(){var e=this;this.isSelect()&&(this.appLoading=!1,this.roleVisible=!0,a.i(d.a)(this,{orgId:this.rowData.orgId},"/aas/admin/role/queryAllRole.do",function(t){if(t.data.rows){e.roleList=t.data.rows;for(var a=0;a<e.roleList.length;a++)if(e.roleList[a].owned)return void(e.role=e.roleList[a].roleId);e.role=""}}))},appConfig:function(){var e=this;this.appLoading=!0;var t={orgId:this.rowData.orgId,roleIds:this.role};a.i(d.b)(this,t,"/aas/admin/role/distrRole.do",function(t){t.data&&t.data.type&&(e.roleVisible=!1,e.$message({message:"分配成功",type:"success"}),e.reload()),e.appLoading=!1})},isSelect:function(){return!!this.rowData||(this.$notify.info({title:"消息",message:"请选择一条记录"}),!1)},changeDataFn:function(e,t){e.children=[];for(var a=1;a<t.length;a++){t[a].orgParentId==e.orgId&&e.children.push(t[a]);for(var r=0;r<e.children.length;r++)this.changeDataFn(e.children[r],t)}},confirm:function(e,t,r){var o=this;this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.i(d.b)(o,{orgId:o.rowData.orgId},t,function(e){e.data&&e.data.type&&(o.$message({message:r,type:"success"}),o.reload())})}).catch(function(){})}}),components:{treeGrid:i.treeGrid}}},566:function(e,t,a){var r=a(662);e.exports={treeGrid:r}},567:function(e,t,a){"use strict";function r(e){if(!(this instanceof r))return new r(e,null,null)}var o=a(572),i=a.n(o),n=a(18);r.treeToArray=function(e,t,a,o){var d=[];return i()(e).forEach(function(e){void 0===e._expanded&&n.default.set(e,"_expanded",o),t&&n.default.set(e,"_parent",t);var i=0;if(void 0!==a&&null!==a&&(i=a+1),n.default.set(e,"_level",i),d.push(e),e.children&&e.children.length>0){var l=r.treeToArray(e.children,e,i,o);d=d.concat(l)}}),d},t.a=r},568:function(e,t,a){"use strict";var r=a(567);t.a={MSDataTransfer:r.a}},572:function(e,t,a){e.exports={default:a(577),__esModule:!0}},577:function(e,t,a){a(190),a(589),e.exports=a(47).Array.from},581:function(e,t,a){"use strict";var r=a(57),o=a(125);e.exports=function(e,t,a){t in e?r.f(e,t,o(0,a)):e[t]=a}},589:function(e,t,a){"use strict";var r=a(64),o=a(79),i=a(185),n=a(194),d=a(193),l=a(130),s=a(581),c=a(199);o(o.S+o.F*!a(195)(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,o,u,g=i(e),f="function"==typeof this?this:Array,m=arguments.length,p=m>1?arguments[1]:void 0,h=void 0!==p,v=0,b=c(g);if(h&&(p=r(p,m>2?arguments[2]:void 0,2)),void 0==b||f==Array&&d(b))for(t=l(g.length),a=new f(t);t>v;v++)s(a,v,h?p(g[v],v):g[v]);else for(u=b.call(g),a=new f;!(o=u.next()).done;v++)s(a,v,h?n(u,p,[o.value,v],!0):o.value);return a.length=v,a}})},602:function(e,t,a){t=e.exports=a(480)(!1),t.push([e.i,".iconfont[data-v-38c4608c]{font-size:16px;margin-right:4px}.handle[data-v-38c4608c]{margin-bottom:6px}.el-radio-group .el-radio[data-v-38c4608c]{margin-left:15px}",""])},612:function(e,t,a){t=e.exports=a(480)(!1),t.push([e.i,'.ms-tree-space[data-v-5d97c428]{position:relative;top:1px;display:inline-block;font-family:Glyphicons Halflings;font-style:normal;font-weight:400;line-height:1;width:18px;height:14px}.paddg[data-v-5d97c428]{padding:0 6px;color:#99a9bf}table td[data-v-5d97c428]{line-height:32px}.ms-tree-space[data-v-5d97c428]:before{content:""}',""])},631:function(e,t,a){var r=a(602);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(481)("45a93ef4",r,!0)},641:function(e,t,a){var r=a(612);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(481)("896b371e",r,!0)},662:function(e,t,a){a(641);var r=a(181)(a(536),a(687),"data-v-5d97c428",null);e.exports=r.exports},675:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"organizitionPage"},[a("section",{staticClass:"handle"},[e._l(e.buttonData,function(t,r){return e.buttonData.length?[a("el-button",{key:r,attrs:{size:"small",type:"primary"},on:{click:function(a){e.buttonClick(t.buttonLink)}}},[a("i",{staticClass:"iconfont",class:t.iconLink}),e._v(e._s(t.popedomName))])]:e._e()})],2),e._v(" "),a("div",{staticClass:"hello"},[a("tree-grid",{attrs:{columns:e.columns,"tree-structure":!0,"data-source":e.dataSource},on:{transRow:e.transRow}})],1),e._v(" "),a("el-dialog",{attrs:{size:"tiny",title:"添加",visible:e.addVisiable,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addVisiable=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.rules,"label-width":"110px"}},[a("el-form-item",{attrs:{prop:"addorgName",label:"机构名称"}},[a("el-input",{ref:"addInput",attrs:{"auto-complete":"off"},model:{value:e.addForm.addorgName,callback:function(t){e.addForm.addorgName=t},expression:"addForm.addorgName"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"addorgParentId",label:"上级机构"}},[a("el-select",{model:{value:e.addForm.addorgParentId,callback:function(t){e.addForm.addorgParentId=t},expression:"addForm.addorgParentId"}},e._l(e.addBranchList,function(e,t){return a("el-option",{key:t,attrs:{label:e.orgName,value:e.orgId}})}))],1),e._v(" "),a("el-form-item",{attrs:{prop:"addorgContact",label:"机构联系人"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.addorgContact,callback:function(t){e.addForm.addorgContact=t},expression:"addForm.addorgContact"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"addorgTel",label:"机构联系电话"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.addorgTel,callback:function(t){e.addForm.addorgTel=t},expression:"addForm.addorgTel"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"addorgAddress",label:"机构地址"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off"},model:{value:e.addForm.addorgAddress,callback:function(t){e.addForm.addorgAddress=t},expression:"addForm.addorgAddress"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"addremark",label:"描述"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off"},model:{value:e.addForm.addremark,callback:function(t){e.addForm.addremark=t},expression:"addForm.addremark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.addLoading},on:{click:function(t){e.checkOrgName()}}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.addVisiable=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{size:"tiny",title:"更新",visible:e.editVisiable,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editVisiable=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"label-width":"110px"}},[a("el-form-item",{attrs:{prop:"editorgName",label:"机构名称"}},[a("el-input",{ref:"editInput",attrs:{"auto-complete":"off"},model:{value:e.editForm.editorgName,callback:function(t){e.editForm.editorgName=t},expression:"editForm.editorgName"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"editorgParentId",label:"上级机构"}},[a("el-select",{model:{value:e.editForm.editorgParentId,callback:function(t){e.editForm.editorgParentId=t},expression:"editForm.editorgParentId"}},e._l(e.addBranchList,function(e,t){return a("el-option",{key:t,attrs:{label:e.orgName,value:e.orgId}})}))],1),e._v(" "),a("el-form-item",{attrs:{prop:"editorgContact",label:"机构联系人"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.editorgContact,callback:function(t){e.editForm.editorgContact=t},expression:"editForm.editorgContact"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"editorgTel",label:"机构联系电话"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.editorgTel,callback:function(t){e.editForm.editorgTel=t},expression:"editForm.editorgTel"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"editorgAddress",label:"机构地址"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off"},model:{value:e.editForm.editorgAddress,callback:function(t){e.editForm.editorgAddress=t},expression:"editForm.editorgAddress"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"editremark",label:"描述"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off"},model:{value:e.editForm.editremark,callback:function(t){e.editForm.editremark=t},expression:"editForm.editremark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.editLoading},on:{click:function(t){e.editOrg()}}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.editVisiable=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{size:"tiny",title:"分配角色",visible:e.roleVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.roleVisible=t}}},[a("el-radio-group",{model:{value:e.role,callback:function(t){e.role=t},expression:"role"}},[e._l(e.roleList,function(t,r){return a("el-radio",{key:r,staticStyle:{display:"block"},attrs:{label:t.roleId}},[e._v(e._s(t.roleName))])}),e._v(" "),a("el-radio",{staticStyle:{display:"block"},attrs:{label:""}},[e._v("无角色")])],2),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.appLoading},on:{click:function(t){e.appConfig()}}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.roleVisible=!1}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]}},687:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.data,"highlight-current-row":"",border:"",height:e.tableHeight,"row-style":e.showTr},on:{"current-change":e.select}},e._l(e.columns,function(t,r){return a("el-table-column",{key:t.dataIndex,attrs:{label:t.text,"min-width":t.width},scopedSlots:e._u([{key:"default",fn:function(o){return[e._l(o.row._level,function(t,o){return e.spaceIconShow(r)?a("span",{staticClass:"ms-tree-space"}):e._e()}),e._v(" "),e.toggleIconShow(r,o.row)?a("span",{staticClass:"button is-outlined is-primary is-small paddg",on:{click:function(t){e.toggle(o.$index)}}},[o.row._expanded?e._e():a("i",{staticClass:"el-icon-caret-right",attrs:{"aria-hidden":"true"}}),e._v(" "),o.row._expanded?a("i",{staticClass:"el-icon-caret-bottom",attrs:{"aria-hidden":"true"}}):e._e()]):0===r?a("span",{staticClass:"ms-tree-space"}):e._e(),e._v("\n      "+e._s(o.row[t.dataIndex])+"\n    ")]}}])})}))},staticRenderFns:[]}}});